<HEAD>
<TITLE>cleoks/typscn/typsio/asyni.F</TITLE>
</HEAD>
<BODY>
<PRE>
*
* $Id$
*
* $Log$
* Revision 1.1  2000/06/19 20:00:20  eugenio
* Initial revision
*
* Revision 1.1.1.1  1995/08/01  18:00:14  nk
* Consolidation
*
* Revision 1.1  1995/07/31 19:40:35  nk
* Added typscn
*
* Revision 1.1.1.1  1994/10/05  13:45:41  zfiles
* first version of typscn in CVS
*
*
#include &QUOT<A HREF="../../../sys/CLEO_machine.html">sys/CLEO_machine.h</A>&QUOT
#include &QUOT<A HREF="../../../pilot.html">pilot.h</A>&QUOT
#if (defined(CLEO_VAX))&&(!defined(CLEO_VAXF77))
*CMZ :  1.00/08 14/08/90  14.40.57  by  J. D. Lewis
*CMZ :  1.00/08 26/02/90  22.35.15  by  Ian C. Brock
*CMZ :  1.00/03 28/11/89  14.49.48  by  J. D. Lewis
*CMZ :  1.00/00 12/05/89  17.29.21  by  Ian C. Brock
*-- Author :
C
C----------------------------------------------------------------------
C Init channel for asynchronous read
C
*=*=*=*= ASYNI.html =*=*=*=*

</PRE>

<A HREF="http://w4.lns.cornell.edu/Harvest/brokers/w4-public/">Search Keyword</A>
<H1>SUBROUTINE ASYNI</H1>

<PRE>

      SUBROUTINE <A NAME=asyni>ASYNI</A>(<A HREF="../../../cleoks/typscn/typsio/asyni.html#ltty">LTTY</A>,<A HREF="../../../cleoks/typscn/typsio/asyni.html#input_channel">INPUT_CHANNEL</A>)
C
CJDL  IMPLICIT INTEGER*4 (A-Z)
C
      INCLUDE <A HREF="../../../cleoks/typscn/typsio/asyni.html#'($ssdef)/nolist'">'($SSDEF)/NOLIST'</A>
      INCLUDE <A HREF="../../../cleoks/typscn/typsio/asyni.html#'($dcdef)/nolist'">'($DCDEF)/NOLIST'</A>
      INCLUDE <A HREF="../../../cleoks/typscn/typsio/asyni.html#'($dvidef)/nolist'">'($DVIDEF)/NOLIST'</A>
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typpar.html">cleoks/typscn/typcde/typpar.inc</A>&QUOT
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typchr.html">cleoks/typscn/typcde/typchr.inc</A>&QUOT
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typscn.html">cleoks/typscn/typcde/typscn.inc</A>&QUOT
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typstr.html">cleoks/typscn/typcde/typstr.inc</A>&QUOT
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typctl.html">cleoks/typscn/typcde/typctl.inc</A>&QUOT
C
      INTEGER  <A NAME=devclass>DEVCLASS</A>
      INTEGER*2  <A NAME=input_channel>INPUT_CHANNEL</A>
      INTEGER  <A NAME=istat>ISTAT</A>
      INTEGER*2  <A NAME=len>LEN</A>
C
      INTEGER <A NAME=sys>SYS</A>$<A NAME=getdviw>GETDVIW</A>,<A NAME=sys>SYS</A>$<A NAME=assign>ASSIGN</A>
      STRUCTURE /DVILIST/
      UNION
      MAP
          INTEGER*2 <A NAME=len>LEN</A>
          INTEGER*2 <A NAME=code>CODE</A>
          INTEGER*4 <A NAME=addr>ADDR</A>
          INTEGER*4 <A NAME=rlen>RLEN</A>
      END MAP
      MAP
          INTEGER*4 <A NAME=last>LAST</A>
      END MAP
      END UNION
      END STRUCTURE
C
      CHARACTER*80 <A NAME=text>TEXT</A>
      LOGICAL <A NAME=ltty>LTTY</A>
      RECORD /DVILIST/LIST(3)
C
      LIST(1).LEN = 4
      LIST(1).CODE = DVI$_DEVCLASS
      LIST(1).ADDR = %LOC(DEVCLASS)
      LIST(2).LEN = 4
      LIST(2).CODE = DVI$_DEVBUFSIZ
      LIST(2).ADDR = %LOC(NDEVBF)
      LIST(3).LAST = 0
      <A HREF="../../../cleoks/typscn/typsio/asyni.html#istat">ISTAT</A> = <A HREF="../../../cleoks/typscn/typsio/asyni.html#sys">SYS</A>$<A NAME=ASYNI_GETDVIW_1  HREF="../../../cleoks/typscn/typsio/asyni.html#getdviw">GETDVIW</A>(,,'SYS$COMMAND',<A HREF="../../../mcseq/ftgeom/fgeomrd.html#list">LIST</A>,,,,)
      IF (<A HREF="../../../cleoks/typscn/typsio/asyni.html#istat">ISTAT</A>.EQ.<A HREF="../../../cleoks/typscn/typsio/asyni.html#ss">SS</A>$<A HREF="../../../cleoks/typscn/typsio/asyni.html#_normal">_NORMAL</A> .OR. <A HREF="../../../cleoks/typscn/typsio/asyni.html#istat">ISTAT</A>.EQ.<A HREF="../../../cleoks/typscn/typsio/asyni.html#ss">SS</A>$<A HREF="../../../cleoks/typscn/typsio/asyni.html#_bufferovf">_BUFFEROVF</A>) THEN
        IF (<A HREF="../../../cleoks/typscn/typsio/asyni.html#devclass">DEVCLASS</A> .EQ. <A HREF="../../../cleoks/typscn/typsio/asyni.html#dc">DC</A>$<A HREF="../../../cleoks/typscn/typsio/asyni.html#_term">_TERM</A>) THEN
                <A HREF="../../../cleoks/typscn/typsio/asyni.html#ltty">LTTY</A> = .TRUE.
        ELSE IF (<A HREF="../../../cleoks/typscn/typsio/asyni.html#devclass">DEVCLASS</A> .EQ. <A HREF="../../../cleoks/typscn/typsio/asyni.html#dc">DC</A>$<A HREF="../../../cleoks/typscn/typsio/asyni.html#_mailbox">_MAILBOX</A>) THEN
                <A HREF="../../../cleoks/typscn/typsio/asyni.html#ltty">LTTY</A> = .TRUE.
        ELSE
                <A HREF="../../../cleoks/typscn/typsio/asyni.html#ltty">LTTY</A> = .FALSE.
        END IF
      ELSE
        STOP 'TYPSCN: async init GETDEV error'
      END IF
C
      <A HREF="../../../cleoks/typscn/typcde/typctl.html#ndevbf">NDEVBF</A> = <A HREF="../../../cleoks/typscn/typsio/asyni.html#min">MIN</A>(<A HREF="../../../cleoks/typscn/typcde/typpar.html#dimtyd">DIMTYD</A>,<A HREF="../../../cleoks/typscn/typcde/typctl.html#ndevbf">NDEVBF</A>)
C
      IF (<A HREF="../../../cleoks/typscn/typsio/asyni.html#ltty">LTTY</A>) THEN
        <A HREF="../../../cleoks/typscn/typsio/asyni.html#istat">ISTAT</A> = <A HREF="../../../cleoks/typscn/typsio/asyni.html#sys">SYS</A>$<A NAME=ASYNI_ASSIGN_1  HREF="../../../cleoks/typscn/typsio/asyni.html#assign">ASSIGN</A>('SYS$COMMAND',<A HREF="../../../cleoks/typscn/typsio/asyni.html#input_channel">INPUT_CHANNEL</A>,,)
        IF (<A HREF="../../../cleoks/typscn/typsio/asyni.html#istat">ISTAT</A>.NE.<A HREF="../../../cleoks/typscn/typsio/asyni.html#ss">SS</A>$<A HREF="../../../cleoks/typscn/typsio/asyni.html#_normal">_NORMAL</A>) THEN
                CALL <A NAME=ASYNI_SYS_1  HREF="../../../cleoks/typscn/typsio/asyni.html#sys">SYS</A>$<A NAME=ASYNI_GETMSG_1  HREF="../../../cleoks/typscn/typsio/asyni.html#getmsg">GETMSG</A>(%<A NAME=ASYNI_VAL_1  HREF="../../../cleoks/typscn/typsio/asyni.html#val">VAL</A>(<A HREF="../../../cleoks/typscn/typsio/asyni.html#istat">ISTAT</A>),<A HREF="../../../cleoks/typscn/typsio/asyni.html#len">LEN</A>,<A HREF="../../../cleoks/typscn/typsio/asyni.html#text">TEXT</A>,,)
                IF (<A HREF="../../../cleoks/typscn/typcde/typctl.html#iuntyp">IUNTYP</A>.GT.0) WRITE(UNIT=<A HREF="../../../cleoks/typscn/typcde/typctl.html#iuntyp">IUNTYP</A>,FMT=200) <A HREF="../../../cleoks/typscn/typsio/asyni.html#text">TEXT</A>(:<A HREF="../../../cleoks/typscn/typsio/asyni.html#len">LEN</A>)
200             FORMAT (' TYPSCN: async init error ',A)
        END IF
      END IF
C
      RETURN
      END
</PRE>
<PRE>
#endif
</PRE>
<ADDRESS>
<A HREF="http://w4.lns.cornell.edu/cgi-bin/mail?nk">nk@lns62.lns.cornell.edu</A>
</ADDRESS>

</BODY>


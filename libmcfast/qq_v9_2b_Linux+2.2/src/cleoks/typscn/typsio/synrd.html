<HEAD>
<TITLE>cleoks/typscn/typsio/synrd.F</TITLE>
</HEAD>
<BODY>
<PRE>
*
* $Id$
*
* $Log$
* Revision 1.1  2000/06/19 20:00:20  eugenio
* Initial revision
*
* Revision 1.1.1.1  1995/08/01  18:00:15  nk
* Consolidation
*
* Revision 1.1  1995/07/31 19:40:38  nk
* Added typscn
*
* Revision 1.1.1.1  1994/10/05  13:45:41  zfiles
* first version of typscn in CVS
*
*
#include &QUOT<A HREF="../../../sys/CLEO_machine.html">sys/CLEO_machine.h</A>&QUOT
#include &QUOT<A HREF="../../../pilot.html">pilot.h</A>&QUOT
*CMZ :  1.00/12 11/11/91  20.18.58  by  Unknown
*CMZ :  1.00/10 31/05/91  13.48.44  by  Jon Urheim
*-- add select flag for ibm rs6000.
*CMZ :  1.00/08 14/08/90  14.38.15  by  J. D. Lewis
*CMZ :  1.00/08 26/01/90  18.08.16  by  Ian C. Brock
*CMZ :  1.00/03 11/12/89  10.59.34  by  Ian C. Brock
*CMZ :  1.00/02 18/08/89  12.52.39  by  Ian C. Brock
*CMZ :  1.00/00 12/05/89  17.51.28  by  Ian C. Brock
*-- Author :
C
C-------------------------------------------------------------------------
C Synchronous read routine
C
*=*=*=*= SYNRD.html =*=*=*=*

</PRE>

<A HREF="http://w4.lns.cornell.edu/Harvest/brokers/w4-public/">Search Keyword</A>
<H1>SUBROUTINE SYNRD</H1>

<PRE>

      SUBROUTINE <A NAME=synrd>SYNRD</A>
C
#if (defined(CLEO_VAX))&&(!defined(CLEO_VAXF77))
CJDL  IMPLICIT INTEGER (A-Z)
      CHARACTER*80 <A NAME=tprmpt>TPRMPT</A>
      INTEGER <A NAME=lprmpt>LPRMPT</A>
#endif
      INTEGER  <A NAME=ierno>IERNO</A>
      INTEGER  <A NAME=iin>IIN</A>
      INTEGER  <A NAME=n>N</A>
      INTEGER  <A NAME=nn>NN</A>
C
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typpar.html">cleoks/typscn/typcde/typpar.inc</A>&QUOT
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typchr.html">cleoks/typscn/typcde/typchr.inc</A>&QUOT
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typscn.html">cleoks/typscn/typcde/typscn.inc</A>&QUOT
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typstr.html">cleoks/typscn/typcde/typstr.inc</A>&QUOT
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typctl.html">cleoks/typscn/typcde/typctl.inc</A>&QUOT
#if (defined(CLEO_VAX))&&(!defined(CLEO_VAXF77))
#include &QUOT<A HREF="../../../typscn/typcde/kcvax.html">typscn/typcde/kcvax.inc</A>&QUOT
#endif
C
#if defined(CLEO_VAX)||defined(CLEO_IBM)||defined(CLEO_APOLLO)||defined(CLEO_UNI
      IF (<A HREF="../../../cleoks/typscn/typcde/typctl.html#iuntyp">IUNTYP</A>.GT.0 .AND. <A HREF="../../../cleoks/typscn/typcde/typctl.html#iunacc">IUNACC</A>.EQ.5) THEN
#endif
#if defined(CLEO_MAC)
      IF (<A HREF="../../../cleoks/typscn/typcde/typctl.html#iuntyp">IUNTYP</A>.GT.0 .AND. <A HREF="../../../cleoks/typscn/typcde/typctl.html#iunacc">IUNACC</A>.EQ.9) THEN
#endif
          IF (<A HREF="../../../cleoks/typscn/typcde/typstr.html#cwtype">CWTYPE</A>(:<A HREF="../../../cleoks/typscn/typcde/typctl.html#nwtype">NWTYPE</A>).EQ.'.TRUE.') THEN
#if (defined(CLEO_VAX))&&(!defined(CLEO_VAXF77))
C             WRITE (UNIT=IUNTYP,FMT=5100) CTYPNM
C5100         FORMAT(' Waiting for ',A,': ',$)
              <A HREF="../../../cleoks/typscn/typsio/synrd.html#tprmpt">TPRMPT</A> = 'Waiting for ' // <A HREF="../../../cleoks/typscn/typcde/typstr.html#ctypnm">CTYPNM</A> // ':'
              <A HREF="../../../cleoks/typscn/typsio/synrd.html#lprmpt">LPRMPT</A> = 13 + <A HREF="../../../cleoks/typscn/typsio/synrd.html#len">LEN</A>(<A HREF="../../../cleoks/typscn/typcde/typstr.html#ctypnm">CTYPNM</A>)
#endif
#if (defined(CLEO_DECS)||defined(CLEO_SGI))&&(!defined(CLEO_VAXF77))
              WRITE (UNIT=<A HREF="../../../cleoks/typscn/typcde/typctl.html#iuntyp">IUNTYP</A>,FMT=5100) <A HREF="../../../cleoks/typscn/typcde/typstr.html#ctypnm">CTYPNM</A>
5100          FORMAT(' Waiting for ',A,': ',$)
#endif
#if defined(CLEO_IBM)||defined(CLEO_APOLLO)||defined(CLEO_MAC)||defined(CLEO_VAX
              WRITE (UNIT=<A HREF="../../../cleoks/typscn/typcde/typctl.html#iuntyp">IUNTYP</A>,FMT=5100) <A HREF="../../../cleoks/typscn/typcde/typstr.html#ctypnm">CTYPNM</A>
5100          FORMAT(' Waiting for ',A,': ')
#endif
C
          ELSE IF (<A HREF="../../../cleoks/typscn/typcde/typstr.html#cwtype">CWTYPE</A>(:<A HREF="../../../cleoks/typscn/typcde/typctl.html#nwtype">NWTYPE</A>).EQ.'.FALSE.') THEN
#if (defined(CLEO_VAX))&&(!defined(CLEO_VAXF77))
              <A HREF="../../../cleoks/typscn/typsio/synrd.html#tprmpt">TPRMPT</A> = ' '
              <A HREF="../../../cleoks/typscn/typsio/synrd.html#lprmpt">LPRMPT</A> = 1
#endif
              CONTINUE
C
          ELSE
#if (defined(CLEO_VAX))&&(!defined(CLEO_VAXF77))
C             WRITE (UNIT=IUNTYP,FMT=5200) CWTYPE(:NWTYPE)
C5200         FORMAT(1X,A,$)
              <A HREF="../../../cleoks/typscn/typsio/synrd.html#tprmpt">TPRMPT</A> = <A HREF="../../../cleoks/typscn/typcde/typstr.html#cwtype">CWTYPE</A>(:<A HREF="../../../cleoks/typscn/typcde/typctl.html#nwtype">NWTYPE</A>)
              <A HREF="../../../cleoks/typscn/typsio/synrd.html#lprmpt">LPRMPT</A> = <A HREF="../../../cleoks/typscn/typcde/typctl.html#nwtype">NWTYPE</A>
#endif
#if (defined(CLEO_DECS)||defined(CLEO_SGI))&&(!defined(CLEO_VAXF77))
              WRITE (UNIT=<A HREF="../../../cleoks/typscn/typcde/typctl.html#iuntyp">IUNTYP</A>,FMT=5200) <A HREF="../../../cleoks/typscn/typcde/typstr.html#cwtype">CWTYPE</A>(:<A HREF="../../../cleoks/typscn/typcde/typctl.html#nwtype">NWTYPE</A>)
5200          FORMAT(1X,A,$)
#endif
#if defined(CLEO_IBM)||defined(CLEO_APOLLO)||defined(CLEO_MAC)||defined(CLEO_VAX
              WRITE (UNIT=<A HREF="../../../cleoks/typscn/typcde/typctl.html#iuntyp">IUNTYP</A>,FMT=5200) <A HREF="../../../cleoks/typscn/typcde/typstr.html#cwtype">CWTYPE</A>(:<A HREF="../../../cleoks/typscn/typcde/typctl.html#nwtype">NWTYPE</A>)
5200          FORMAT(1X,A)
#endif
C
          END IF
      END IF
C
C IBM, APOLLO and MACINTOSH returns EOF condition for empty lines.
C Worse yet, supsequent reads look for another file with increment sequence
C number.  For terminal I/O we will close 5 and reopen. This seems to work.
C N.B.
C IBM only happy reading 80 characters from TTY. Assume IUNACC=5 means TTY
C input.
C
      <A HREF="../../../cleoks/typscn/typcde/typstr.html#ctydat">CTYDAT</A>=' '
#if (defined(CLEO_VAX))&&(!defined(CLEO_VAXF77))
      <A HREF="../../../cleoks/typscn/typsio/synrd.html#iin">IIN</A> = <A HREF="../../../cleoks/typscn/typcde/typpar.html#dimtyd">DIMTYD</A>
      IF(<A HREF="../../../cleoks/typscn/typcde/typctl.html#iunacc">IUNACC</A>.EQ.5) THEN
          <A HREF="../../../cleoks/typscn/typsio/synrd.html#ierno">IERNO</A> = <A HREF="../../../cleoks/typscn/typsio/synrd.html#smg">SMG</A>$<A NAME=SYNRD_READ_COMPOSED_LINE_1  HREF="../../../cleoks/typscn/typsio/synrd.html#read_composed_line">READ_COMPOSED_LINE</A>(
     +     <A HREF="../../../cleoks/typscn/typcde/kcvax.html#keyb">KEYB</A>,<A HREF="../../../cleoks/typscn/typcde/kcvax.html#keyt">KEYT</A>,<A HREF="../../../cleoks/typscn/typcde/typstr.html#ctydat">CTYDAT</A>,<A HREF="../../../cleoks/typscn/typsio/synrd.html#tprmpt">TPRMPT</A>(1:<A HREF="../../../cleoks/typscn/typsio/synrd.html#lprmpt">LPRMPT</A>)//' ')
          IF(<A HREF="../../../cleoks/typscn/typsio/synrd.html#ierno">IERNO</A>.EQ.<A HREF="../../../cleoks/typscn/typsio/synrd.html#smg">SMG</A>$<A HREF="../../../cleoks/typscn/typcde/kcvax.html#_eof">_EOF</A>) GOTO 100
      ELSE
          READ(UNIT=<A HREF="../../../cleoks/typscn/typcde/typctl.html#iunacc">IUNACC</A>,FMT=5000,END=100) <A HREF="../../../cleoks/typscn/typcde/typstr.html#ctydat">CTYDAT</A>
      ENDIF
#endif
#if defined(CLEO_VAXF77)||defined(CLEO_UNIX)
      <A HREF="../../../cleoks/typscn/typsio/synrd.html#iin">IIN</A> = <A HREF="../../../cleoks/typscn/typcde/typpar.html#dimtyd">DIMTYD</A>
      READ(UNIT=<A HREF="../../../cleoks/typscn/typcde/typctl.html#iunacc">IUNACC</A>,FMT=5000,END=100) <A HREF="../../../cleoks/typscn/typcde/typstr.html#ctydat">CTYDAT</A>
#endif
#if defined(CLEO_APOLLO)
      <A HREF="../../../cleoks/typscn/typsio/synrd.html#iin">IIN</A> = <A HREF="../../../cleoks/typscn/typcde/typpar.html#dimtyd">DIMTYD</A>
      READ(UNIT=<A HREF="../../../cleoks/typscn/typcde/typctl.html#iunacc">IUNACC</A>,FMT=5000,IOSTAT=<A HREF="../../../dedr/dedrseq/dinrm.html#ioerr">IOERR</A>,END=100) <A HREF="../../../cleoks/typscn/typcde/typstr.html#ctydat">CTYDAT</A>
#endif
#if defined(CLEO_IBM)
      IF (<A HREF="../../../cleoks/typscn/typcde/typctl.html#iunacc">IUNACC</A>.EQ.5) THEN
#endif
#if defined(CLEO_MAC)
      IF (<A HREF="../../../cleoks/typscn/typcde/typctl.html#iunacc">IUNACC</A>.EQ.9) THEN
#endif
#if defined(CLEO_IBM)||defined(CLEO_MAC)
          <A HREF="../../../cleoks/typscn/typsio/synrd.html#iin">IIN</A> = 80
      ELSE
          <A HREF="../../../cleoks/typscn/typsio/synrd.html#iin">IIN</A> = <A HREF="../../../cleoks/typscn/typcde/typpar.html#dimtyd">DIMTYD</A>
      END IF
      READ(UNIT=<A HREF="../../../cleoks/typscn/typcde/typctl.html#iunacc">IUNACC</A>,FMT=5000,END=100) <A HREF="../../../cleoks/typscn/typcde/typstr.html#ctydat">CTYDAT</A>(1:<A HREF="../../../cleoks/typscn/typsio/synrd.html#iin">IIN</A>)
#endif
5000  FORMAT(A)
C
C       Strip trailing blanks and tabs
      DO 10 <A HREF="../../../cleoks/typscn/typsio/synrd.html#nn">NN</A>=<A HREF="../../../cleoks/typscn/typsio/synrd.html#iin">IIN</A>,1,-1
          <A HREF="../../../cleoks/typscn/typsio/synrd.html#n">N</A> = <A HREF="../../../cleoks/typscn/typsio/synrd.html#nn">NN</A>
          IF (<A HREF="../../../roarlib/seq/rdtemp.html#index">INDEX</A>(<A HREF="../../../cleoks/typscn/typcde/typchr.html#ctabsp">CTABSP</A>,<A HREF="../../../cleoks/typscn/typcde/typstr.html#ctydat">CTYDAT</A>(<A HREF="../../../cleoks/typscn/typsio/synrd.html#n">N</A>:<A HREF="../../../cleoks/typscn/typsio/synrd.html#n">N</A>)).EQ.0) GO TO 1
10    CONTINUE
      <A HREF="../../../cleoks/typscn/typsio/synrd.html#n">N</A> = 0
C
#if defined(CLEO_IBM)
      GOTO 1
C
100   CONTINUE
      <A HREF="../../../cleoks/typscn/typsio/synrd.html#n">N</A> = 0
      IF (<A HREF="../../../cleoks/typscn/typcde/typctl.html#iunacc">IUNACC</A>.EQ.5) THEN
          CLOSE (UNIT=5)
          OPEN (UNIT=5)
      END IF
#endif
#if defined(CLEO_MAC)
100   CONTINUE
      <A HREF="../../../cleoks/typscn/typsio/synrd.html#n">N</A> = 0
#endif
1     CONTINUE
C
C       Initialize pointers
      <A HREF="../../../avehst/seq/avehstin.html#ipoint">IPOINT</A> = 0
      <A HREF="../../../cleoks/typscn/typcde/typscn.html#kpoint">KPOINT</A> = <A HREF="../../../avehst/seq/avehstin.html#ipoint">IPOINT</A>
      <A HREF="../../../cleoks/typscn/typcde/typscn.html#nchacc">NCHACC</A> = <A HREF="../../../cleoks/typscn/typsio/synrd.html#n">N</A>
      <A HREF="../../../cleoks/typscn/typcde/typscn.html#nchars">NCHARS</A> = <A HREF="../../../cleoks/typscn/typsio/synrd.html#n">N</A>
      <A HREF="../../../cleoks/typscn/typcde/typscn.html#kchars">KCHARS</A> = <A HREF="../../../cleoks/typscn/typsio/synrd.html#n">N</A>
C
#if defined(CLEO_VAX)||defined(CLEO_APOLLO)||defined(CLEO_UNIX)
      GO TO 110
C
100   CONTINUE
      CALL <A NAME=SYNRD_QUOTYP_1  HREF="../../../cleoks/typscn/typsub/quotyp.html">QUOTYP</A>(<A HREF="../../../cleoks/typscn/typcde/typchr.html#cctlz">CCTLZ</A>)
110   CONTINUE
#endif
C
      RETURN
      END
</PRE>
<ADDRESS>
<A HREF="http://w4.lns.cornell.edu/cgi-bin/mail?nk">nk@lns62.lns.cornell.edu</A>
</ADDRESS>

</BODY>


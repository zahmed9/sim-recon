<HEAD>
<TITLE>cleoks/typscn/typscn/iqsscn.F</TITLE>
</HEAD>
<BODY>
<PRE>
*
* $Id$
*
* $Log$
* Revision 1.1  2000/06/19 20:00:19  eugenio
* Initial revision
*
* Revision 1.1.1.1  1995/08/01  18:00:09  nk
* Consolidation
*
* Revision 1.1  1995/07/31 19:39:30  nk
* Added typscn
*
* Revision 1.1.1.1  1994/10/05  13:45:40  zfiles
* first version of typscn in CVS
*
*
#include &QUOT<A HREF="../../../sys/CLEO_machine.html">sys/CLEO_machine.h</A>&QUOT
#include &QUOT<A HREF="../../../pilot.html">pilot.h</A>&QUOT
*CMZ :  1.00/06 05/03/90  08.49.33  by  Ian C. Brock
*CMZ :  1.00/07 13/02/90  13.40.24  by  Ian C. Brock
*CMZ :  1.00/06 26/01/90  10.47.19  by  Ian C. Brock
*-- Author :
*=*=*=*= IQSSCN.html =*=*=*=*

</PRE>

<A HREF="http://w4.lns.cornell.edu/Harvest/brokers/w4-public/">Search Keyword</A>
<H1>INTEGER FUNCTION IQSSCN</H1>

<PRE>

      INTEGER FUNCTION <A NAME=iqsscn>IQSSCN</A>(<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jpoint">JPOINT</A>,<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A>,<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#idelim">IDELIM</A>,<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#astr">ASTR</A>)
C
C----------------------------------------------------------------------
C     Extracts a character string
C     The string should be enclosed in ' ' if the rest of the line
C     is not to be taken
C
      SAVE
C
      INTEGER  <A NAME=i>I</A>
      INTEGER  <A NAME=idelim>IDELIM</A>
      INTEGER  <A NAME=jchars>JCHARS</A>
      INTEGER  <A NAME=jpoint>JPOINT</A>
      INTEGER  <A NAME=nchr>NCHR</A>
C
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typpar.html">cleoks/typscn/typcde/typpar.inc</A>&QUOT
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typchr.html">cleoks/typscn/typcde/typchr.inc</A>&QUOT
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typscn.html">cleoks/typscn/typcde/typscn.inc</A>&QUOT
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typstr.html">cleoks/typscn/typcde/typstr.inc</A>&QUOT
#include &QUOT<A HREF="../../../cleoks/typscn/typcde/typctl.html">cleoks/typscn/typcde/typctl.inc</A>&QUOT
C
      CHARACTER*(*) <A NAME=astr>ASTR</A>
C
      CHARACTER*1 <A NAME=cch>CCH</A>
      CHARACTER*1 <A NAME=cchscn>CCHSCN</A>
      LOGICAL <A NAME=strip>STRIP</A>,<A NAME=quote>QUOTE</A>
      CHARACTER <A NAME=ctemp>CTEMP</A>*(<A NAME=dimcbf>DIMCBF</A>)
C
      <A HREF="../../../cleoks/typscn/typcde/typstr.html#ccbuf">CCBUF</A> = ' '
      <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#astr">ASTR</A>=' '
      <A HREF="../../../cleoks/typscn/typcde/typctl.html#nchuse">NCHUSE</A> = 0
      <A HREF="../../../cleoks/typscn/typcde/typctl.html#nmatch">NMATCH</A> = 0
      DO 10 <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#i">I</A>=1,<A HREF="../../../cleoks/typscn/typcde/typpar.html#dimcli">DIMCLI</A>
      <A HREF="../../../cleoks/typscn/typcde/typctl.html#iclist">ICLIST</A>(<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#i">I</A>) = 0
10    CONTINUE
C
C is anything left on line
      IF (<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A> .LE. 0) THEN
      <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A> = -1
      <A NAME=IQSSCN_IQSSCN_1  HREF="../../../cleoks/typscn/typscn/iqsscn.html#iqsscn">IQSSCN</A> = -1
      <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#idelim">IDELIM</A> = -1
      RETURN
      END IF
C
C     Strip leading blanks and tabs
20    CONTINUE
      <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A> = <A NAME=IQSSCN_CCHSCN_1  HREF="../../../cleoks/typscn/typscn/iqsscn.html#cchscn">CCHSCN</A>(<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jpoint">JPOINT</A>,<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A>)
      IF (<A HREF="../../../roarlib/seq/rdtemp.html#index">INDEX</A>(<A HREF="../../../cleoks/typscn/typcde/typchr.html#ctabsp">CTABSP</A>,<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A>).NE.0) GO TO 20
C
C     If end of line, terminate
      IF (<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A>.EQ.<A HREF="../../../cleoks/typscn/typcde/typchr.html#cones">CONES</A>) THEN
C             nothing
          <A NAME=IQSSCN_IQSSCN_2  HREF="../../../cleoks/typscn/typscn/iqsscn.html#iqsscn">IQSSCN</A> = -1
          <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#idelim">IDELIM</A> = -1
          RETURN
      END IF
C
C     If standard  delimiter, terminate
      IF (<A HREF="../../../roarlib/seq/rdtemp.html#index">INDEX</A>(<A HREF="../../../cleoks/typscn/typcde/typstr.html#cdelim">CDELIM</A>(1:<A HREF="../../../cleoks/typscn/typcde/typctl.html#ndelim">NDELIM</A>),<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A>).NE.0) THEN
C         nothing
          <A NAME=IQSSCN_IQSSCN_3  HREF="../../../cleoks/typscn/typscn/iqsscn.html#iqsscn">IQSSCN</A> = -1
          IF (<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A>.LE.0) THEN
C             nothing useful after delimiter
              <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#idelim">IDELIM</A> = -1
              <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A> = -1
          ELSE
C             more on line
              <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#idelim">IDELIM</A> = 0
          END IF
          RETURN
      END IF
C
C     See if the first character is a '
C
      IF(<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A>.EQ.'''') THEN
          <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#quote">QUOTE</A> = .TRUE.
C
C     If it is not a  quote take the rest of the line, also shifting the
C     pointers, not like ISTRNG
C
      ELSE
          <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#quote">QUOTE</A>  = .FALSE.
C         Back up to get valid character
          <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jpoint">JPOINT</A> = <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jpoint">JPOINT</A> - 1
          <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A> = <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A> + 1
          <A HREF="../../../cleoks/typscn/typcde/typctl.html#nchuse">NCHUSE</A> = <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A>
          DO 30 <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#i">I</A>=1,<A HREF="../../../cleoks/typscn/typcde/typctl.html#nchuse">NCHUSE</A>
              <A HREF="../../../cleoks/typscn/typcde/typstr.html#ccbuf">CCBUF</A>(<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#i">I</A>:<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#i">I</A>) = <A NAME=IQSSCN_CCHSCN_2  HREF="../../../cleoks/typscn/typscn/iqsscn.html#cchscn">CCHSCN</A>(<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jpoint">JPOINT</A>,<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A>)
30        CONTINUE
          <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#idelim">IDELIM</A> = -1
          <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A> = -1
          GOTO 2000
      ENDIF
C
C     Extract characters until next delimiter, quote, or end of line
C
      <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#strip">STRIP</A> = .TRUE.
40    CONTINUE
      IF (<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#strip">STRIP</A>) THEN
          <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A> = <A NAME=IQSSCN_CCHSCN_3  HREF="../../../cleoks/typscn/typscn/iqsscn.html#cchscn">CCHSCN</A>(<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jpoint">JPOINT</A>,<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A>)
C
C         End of line
C
          IF (<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A>.EQ.<A HREF="../../../cleoks/typscn/typcde/typchr.html#cones">CONES</A>) THEN
              <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#strip">STRIP</A> = .FALSE.
              <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#idelim">IDELIM</A> = -1
C
C         Quote found - check if it is the end of the string
C
          ELSEIF(<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#quote">QUOTE</A> .AND. <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A>.EQ.'''') THEN
              <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#strip">STRIP</A> = .FALSE.
C
C             Get the next character which should be the delimiter
C
              <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A> = <A NAME=IQSSCN_CCHSCN_4  HREF="../../../cleoks/typscn/typscn/iqsscn.html#cchscn">CCHSCN</A>(<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jpoint">JPOINT</A>,<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A>)
C             nothing after delimiter
              IF (<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A>.LE.0) THEN
                  <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#idelim">IDELIM</A> = -1
                  <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A> = -1
C
C             More on line
C             See if the next character is a quote also - if it is
C             add it to the string and keep going
C
              ELSEIF(<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A>.EQ.'''') THEN
                  <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#strip">STRIP</A> = .TRUE.
                  <A HREF="../../../cleoks/typscn/typcde/typctl.html#nchuse">NCHUSE</A> = <A HREF="../../../cleoks/typscn/typcde/typctl.html#nchuse">NCHUSE</A> + 1
                  <A HREF="../../../cleoks/typscn/typcde/typstr.html#ccbuf">CCBUF</A>(<A HREF="../../../cleoks/typscn/typcde/typctl.html#nchuse">NCHUSE</A>:<A HREF="../../../cleoks/typscn/typcde/typctl.html#nchuse">NCHUSE</A>) = <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A>
              ELSE
                  IF(<A HREF="../../../roarlib/seq/rdtemp.html#index">INDEX</A>(<A HREF="../../../cleoks/typscn/typcde/typstr.html#cdelim">CDELIM</A>(1:<A HREF="../../../cleoks/typscn/typcde/typctl.html#ndelim">NDELIM</A>),<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A>).NE.0) THEN
                      <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#idelim">IDELIM</A> = 0
                  ELSE
                      <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#idelim">IDELIM</A> = <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#ichar">ICHAR</A>(<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A>)
                  ENDIF
              ENDIF
C
C         standard delimter termination
C
          ELSEIF(.NOT.<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#quote">QUOTE</A> .AND. <A HREF="../../../roarlib/seq/rdtemp.html#index">INDEX</A>(<A HREF="../../../cleoks/typscn/typcde/typstr.html#cdelim">CDELIM</A>(1:<A HREF="../../../cleoks/typscn/typcde/typctl.html#ndelim">NDELIM</A>),<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A>).NE.0) THEN
              <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#strip">STRIP</A> = .FALSE.
C             nothing after delimiter
              IF (<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A>.LE.0) THEN
                  <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#idelim">IDELIM</A> = -1
                  <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#jchars">JCHARS</A> = -1
C             more on line
              ELSE
                  <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#idelim">IDELIM</A> = 0
              END IF
          ELSE
              <A HREF="../../../cleoks/typscn/typcde/typctl.html#nchuse">NCHUSE</A> = <A HREF="../../../cleoks/typscn/typcde/typctl.html#nchuse">NCHUSE</A> + 1
              <A HREF="../../../cleoks/typscn/typcde/typstr.html#ccbuf">CCBUF</A>(<A HREF="../../../cleoks/typscn/typcde/typctl.html#nchuse">NCHUSE</A>:<A HREF="../../../cleoks/typscn/typcde/typctl.html#nchuse">NCHUSE</A>) = <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#cch">CCH</A>
          END IF
          GO TO 40
      END IF
C
2000  CONTINUE
      <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#nchr">NCHR</A> = <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#min">MIN</A>(<A HREF="../../../cleoks/typscn/typcde/typctl.html#nchuse">NCHUSE</A>,<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#len">LEN</A>(<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#astr">ASTR</A>))
      <A HREF="../../../cleoks/typscn/typscn/iqsscn.html#astr">ASTR</A>=<A HREF="../../../cleoks/typscn/typcde/typstr.html#ccbuf">CCBUF</A>(1:<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#nchr">NCHR</A>)
      <A NAME=IQSSCN_IQSSCN_4  HREF="../../../cleoks/typscn/typscn/iqsscn.html#iqsscn">IQSSCN</A>=<A HREF="../../../cleoks/typscn/typscn/iqsscn.html#nchr">NCHR</A>
C
      RETURN
      END
</PRE>
<ADDRESS>
<A HREF="http://w4.lns.cornell.edu/cgi-bin/mail?nk">nk@lns62.lns.cornell.edu</A>
</ADDRESS>

</BODY>


*
* $Id$
*
* $Log$
* Revision 1.1  2000/06/19 20:00:34  eugenio
* Initial revision
*
* Revision 1.1.1.1  1994/10/08  02:21:28  zfiles
* first version of qqlib in CVS
*
*
#include "sys/CLEO_machine.h"
#include "pilot.h"
*CMZ :  1.00/00 04/06/90  18.55.45  by  Jorge L. Rodriguez
*-- Author :

      SUBROUTINE QED011(ARG1,ARG2,ARG3,ARG4,ARG5)

      IMPLICIT DOUBLE PRECISION(A-H,K,O-Z)
      COMMON/QED000/IMODDD,IOUT
      COMMON / BAPARM / SIG0,SIGS,SIGH,SIGT,WT(18)
     *                 ,YSOFT,K0,KRAT,DMIN,DMAX,XLCMIN,XM2,TWOPI
     *                  ,EM2,CMIN,CMAX,WMAX,ZSOFT,EBEAM
     *                  ,SIGSW,WTWT(2)
        EBEAM=ARG1
        THMIN=ARG2
        THMAX=ARG3
         KMIN=ARG4
         KMAX=ARG5
      WMAX=2.D0
      D O 1 I=1,18
    1 WT(I)=0.
      WT(13)=WMAX
      WT(17)=WMAX
      WTWT(1)=0.
      WTWT(2)=0.
      XM2=(0.511D-03/EBEAM)**2
      EM2=1.D0+.5D0*XM2
      XL2=DLOG(2./XM2)
      TWOPI=4.D0*DASIN(1.D0)            !6. 2831 8530 7179 586D0
      CMIN=DCOS(THMAX*TWOPI/360.D0)
      CMAX=DCOS(THMIN*TWOPI/360.D0)
      DMIN=0.5D0/DSIN(THMAX*TWOPI/720.D0)**2    !1./(1.-CMIN)
      DMAX=0.5D0/DSIN(THMIN*TWOPI/720.D0)**2    !1./(1.-CMAX)
      XLCMIN=XL2-DLOG(DMIN)                     !XL2+DLOG(1.-CMIN)
      XLCMAX=XL2-DLOG(DMAX)                     !XL2+DLOG(1.-CMAX)
      SIG0=8.1427/EBEAM**2*(
     . 16.*(DMAX-DMIN) + 16.*DLOG(DMIN/DMAX) + 9.*(CMAX-CMIN)
     . + (CMAX**2-CMIN**2) + 1./3.*(CMAX**3-CMIN**3)         )
      K0=0.01D0
      GOTO 9191
C
C
      ENTRY QED014(ARG1,ARG2)
      K0=ARG1
      KMAX=ARG2
C
C
 9191 K1=DMAX1(K0,KMIN)
      KRAT=KMAX/K1
      SIGH=1.2105/EBEAM**2*DLOG(KRAT)*
     . ((1.D0+XLCMAX)*DMAX - (1.D0+XLCMIN)*DMIN )
      SIGS=0.
      SIGSW=0.
      SIGT=SIGH
      YSOFT=0.
      ZSOFT=0.
      IF(KMIN.GE.K0) GOTO 411
C
C
      NINTGR=1000
      D O 3 I=1,NINTGR
      R=(I-0.5D0)/DFLOAT(NINTGR)
      OMC=1.D0/(R*DMAX+(1.D0-R)*DMIN)
      C=1.D0-OMC
      CALL VIRSOF(EBEAM,K1,OMC,BORN,CORR,CORR3)
      DSIGSS=BORN*(1.D0+CORR)*OMC**2
      SIGS=SIGS+DSIGSS
    3 SIGSW=SIGSW+DSIGSS*CORR3/(1.D0+CORR)
      DSIGSS=TWOPI*(DMAX-DMIN)/DFLOAT(NINTGR)
      SIGS=SIGS*DSIGSS
      SIGSW=SIGSW*DSIGSS
C--SIGS=2*PI*INTGRL(VIRSOF/(1-C)**2)
      SIGT=SIGS+SIGH
      YSOFT=SIGS/SIGT
      ZSOFT=(DMAX-DMIN)/SIGS*TWOPI
C
C
  411 SIGS=SIGS/SIG0
      SIGSW=SIGSW/SIG0
      SIGH=SIGH/SIG0
      SIGT=SIGT/SIG0
      WRITE(IOUT,5) EBEAM,THMIN,THMAX,K1,KMAX,SIG0,SIGS,SIGSW,SIGH,SIGT
C*****TYPE        5,EBEAM,THMIN,THMAX,K1,KMAX,SIG0,SIGS,SIGSW,SIGH,SIGT
    5 FORMAT(/,90(1H-),/,
     . 37H INITIALIZATION FOR BHABHA SCATTERING,/,
     . 37H                         BEAM ENERGY ,F15.6,4H GEV,/,
     . 37H            MINIMUM SCATTERING ANGLE ,F15.6,8H DEGREES,/,
     . 37H            MAXIMUM SCATTERING ANGLE ,F15.6,8H DEGREES,/,
     . 37H  MINIMUM HARD BREMSSTRAHLUNG ENERGY ,F15.6,/,
     . 37H  MAXIMUM HARD BREMSSTRAHLUNG ENERGY ,F15.6,/,
     . 37H          LOWEST ORDER CROSS SECTION ,F20.8,3H NB,/,
     . 37H  APPROX. CROSS SECTION IN SOFT PART ,F15.6,/,
     . 37H  APPROX. Z0-INTERFERENCE CONTRIBUTN ,F15.6,/,
     . 37H  APPROX. CROSS SECTION IN HARD PART ,F15.6,/,
     . 37H         APPROX. CROSS SECTION TOTAL ,F15.6,//)
      K0=K1
        RETURN
        END

#ifndef HIT_TRACK_STRUCT_INC
#define HIT_TRACK_STRUCT_INC

c
c
c   Rob Kutschke, Sept 24, 1998.
c
c   Structure to define a hit generated by mcfast.
c
c   -------------------------------------------------------
c
c   WARNING: if you change this file, also make sure you change 
c            hit_track_struct.h !
c
c   -------------------------------------------------------- 
c

#include "const.inc"
#include "trk_channel_struct.inc"

c Track hit parametrization

      structure /hit_trk_s/
        integer hep                !Position of track in /HEPEVT/ list
        integer trace              !Position of hit in trace list
        record /trk_channel_struct/ chan  !Device info (layer, wire, etc.)
        DFLOAT pos(3)              !See below.
        DFLOAT dircos(3)           !See below.
        DFLOAT dircos2(3)          !See below.
        DFLOAT dtime_exact         !Drift time before smearing
        DFLOAT dtime               !Drift time after smearing (if applicable)
        DFLOAT dtime_sigma         !Error in drift time (if applicable)
        DFLOAT dmeas_exact         !Measured quantity before smearing
        DFLOAT dmeas               !Measured quantity after smearing
        DFLOAT dmeas_sigma         !Error in measured quantity
        DFLOAT dpix_exact(2)       !Pixel meas. before smearing
        DFLOAT dpix(2)             !Pixel quantities after smearing
        DFLOAT dpix_cov(2,2)       !Covariance matrix of pixel meas.
      end structure

c
c The meaning of pos(3), dircos(3) and dircos2(3).
c
c dircos2(3) only has meaning for pixel detectors.  It should be
c zeroed elsewhere.
c 
c
c 1) For both axial and stereo wires in a drift chamber, pos(3) contains
c    a point on the wire and dircos(3) contains a unit vector in the
c    direction of the wire.  The point can be anywhere on the wire.
c
c 2) For a barrel silicon strip detector, pos(3) contains the world
c    coordinates the local origin (see below).  Dircos(3) contains 
c    a unit vector in the direction of the measurement.  
c
c 3) For a pixel detector, pos(3) contains the world coordinates of
c    the local origin, dircos(3) contain a unit vector in the
c    direction of the local x measurement and dircos2(3) contains
c    a unit vector in the direction of the local y measurement.
c
c 4) For forward strip detectors (sidisk), pos(3) contains the position
c    of the wafer local origin and dircos(3) contains a unit vector in
c    the direction of the measurement.
c
c 5) For forward tracking chambers, pos(3) contains the wire local origin
c    and dircos(3) contains a unit vector in the direction of the measurement.
c    The wire local origin is a point on the wire which was hit.
c    The direction of measurement is perpendicular to the wire direction
c    and is in the plane of the device.
c
c See the relevant trk_make_*_hit.F routine for more details.
c
c For pixel detectors the pixels measure local coorindates (m,n).
c These are computed as:
c 
c m = ( \vec{x} - \vec{x_0} ) \dot \hat{u}
c n = ( \vec{x} - \vec{x_0} ) \dot \hat{v}
c
c where,
c \vec{x}   is the point that the track crosses the plane,
c \vec{x_0} is the local origin
c \vec{u}   is a unit vector along the local x axis ( dircos )
c \vec{v}   is a univ vector along the local y axis ( dircos2 )
c
c In the above equations, (m,n) are quantities measured in the
c local coordinate system of the plane but all other quantities
c are given in the world coordinate system.
c
c For other planar devices, silicon strips and forward trackers,
c the algebra is the same but only the component selected by
c dircos is meaningful.
c
c 
c
#endif
c
c$Id$
c
c$Log$
cRevision 1.1  2000/06/19 19:58:37  eugenio
cInitial revision
c
cRevision 1.6  2000/01/20 17:23:59  kutschke
cUpdated comments.
c
c Revision 1.5  2000/01/20  01:06:33  mcbride
c add 2nd dircos variable
c
c Revision 1.4  1998/09/25  02:39:16  kutschke
c Add warning about new .h version.
c
c Revision 1.3  1997/12/02  22:38:09  kutschke
c Improve comments on pos and dircos. Add Id and Log.
c
c Revision 1.2.14.1  1997/12/02  22:08:44  kutschke
c Improve comments on pos and dircos. Add Id and Log.
c
c
